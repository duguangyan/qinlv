(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{1657:function(t,i,e){},4296:function(t,i,e){"use strict";var s,c=function(){var t=this,i=t.$createElement,s=(t._self._c,e("9bdb"));t._isMounted||(t.e0=function(i){t.isEdit=!t.isEdit}),t.$mp.data=Object.assign({},{$root:{m0:s}})},o=[];e.d(i,"b",function(){return c}),e.d(i,"c",function(){return o}),e.d(i,"a",function(){return s})},"78d3":function(t,i,e){"use strict";e.r(i);var s=e("4296"),c=e("9818");for(var o in c)"default"!==o&&function(t){e.d(i,t,function(){return c[t]})}(o);e("cb8c");var a,n=e("f0c5"),l=Object(n["a"])(c["default"],s["b"],s["c"],!1,null,"7e77049a",null,!1,s["a"],a);i["default"]=l.exports},9818:function(t,i,e){"use strict";e.r(i);var s=e("a9e9"),c=e.n(s);for(var o in s)"default"!==o&&function(t){e.d(i,t,function(){return s[t]})}(o);i["default"]=c.a},a9e9:function(t,i,e){"use strict";(function(t,s){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=r(e("8c11")),o=r(e("9e8e")),a=r(e("8b8c")),n=r(e("122c")),l=r(e("e0d7")),u=r(e("f585")),h=e("d489");function r(t){return t&&t.__esModule?t:{default:t}}var d=function(){return e.e("components/common/Dialog").then(e.bind(null,"3b86"))},f=function(){return e.e("components/common/TabBar").then(e.bind(null,"4d22"))},m={data:function(){return{checkIndex:1,hasData:!1,title:"您确定删除商品吗?",confirmText:"删除",cancelText:"再想想",isShow:!1,list:[],defaultUrl:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2180358788,168891397&fm=26&gp=0.jpg",isEdit:!1,Checked:c.default,Uncheck:o.default,Plat:a.default,isCheckAll:!1,validTotal:0,validChecked:0,totalMoney:0,clickNum:0,isColor999:!1,isclock:!1,clock:!0,platform:0}},components:{Dialog:d,TabBar:f},onTabItemTap:function(t){},onLoad:function(){console.log(t("2222222222222222222"," at pages\\order\\order.vue:140")),console.log(t("onLoad"," at pages\\order\\order.vue:141")),this.platform=s.getStorageSync("platform"),s.setStorageSync("wxLogin","1")},onShow:function(){s.getStorageSync("access_token")?(this.getCartOrderList(),this.platform=s.getStorageSync("platform")):s.navigateTo({url:"/pages/login/login"})},methods:{doConfirm:function(){this.doDel()},doCancel:function(){this.isShow=!1},goDetail:function(t,i){s.navigateTo({url:"/pages/order/goodsDetail/goodsDetail?shopId="+t+"&goodsId="+i})},submit:function(){var t=this;if(!this.clock)return!1;this.clock=!1;var i=[];this.list.forEach(function(t){t.items.forEach(function(e){1==e.checked&&4!=t.status&&i.push(e.cartId)})});var e=s.getStorageSync("uid"),c={userId:e,cartIdList:i};(0,h.getOrderCart)(c).then(function(i){"1000"===i.code?(t.clock=!0,s.navigateTo({url:"/pages/order/submit/submit?submitData="+JSON.stringify(i.data)})):(l.default.tips(i.message||"结算失败"),t.clock=!0)}).catch(function(i){l.default.tips(i.message||"结算失败"),t.clock=!0})},goPay:function(){this.totalMoney>0?this.submit():l.default.tips("请选择进货单商品")},calculationTotalMoney:function(){var t=this;this.totalMoney=0,this.validTotal=0,this.list.forEach(function(i){i.items.forEach(function(i){1===i.checked&&4!==i.status&&(t.totalMoney=n.default.accAdd(t.totalMoney,i.totalPrice),t.validTotal++)})})},clickInput:function(t,i){this.clickNum=this.list[t].items[i].num},changInput:function(t,i,e){var s=t.target.value;u.default.isNumber(s)?s<this.list[i].items[e].startNum?(l.default.tips("数量不能小于起批量:"+this.list[i].items[e].startNum),this.list[i].items[e].num=this.list[i].items[e].startNum,this.changeNum(i,e,this.list[i].items[e].skuId,this.list[i].items[e].startNum)):s>this.list[i].items[e].stock?(l.default.tips("数量不能超过库存量:"+this.list[i].items[e].stock),this.list[i].items[e].num=this.list[i].items[e].stock,this.changeNum(i,e,this.list[i].items[e].skuId,this.list[i].items[e].stock)):this.changeNum(i,e,this.list[i].items[e].skuId,s):(l.default.tips("请输入正确的数量"),this.changeNum(i,e,this.list[i].items[e].skuId,this.list[i].items[e].startNum))},changeNum:function(i,e,s,c){var o=this;if(!this.isclock){var a={num:c,skuId:s,isLoading:1};this.isclock=!0,(0,h.getCartChangeNum)(a).then(function(s){"1000"===s.code?(o.list[i].items[e].num=s.data.num,o.list[i].items[e].price=s.data.price,o.list[i].items[e].totalPrice=s.data.totalPrice,o.list[i].items[e].isColor999=!1,o.calculationTotalMoney(),o.isclock=!1):(l.default.tips(s.message||"修改数量失败"),o.list[i].items[e].isColor999=!0,o.isclock=!1,console.log(t(o.list," at pages\\order\\order.vue:317")))}).catch(function(t){l.default.tips(t.message||"修改数量失败"),o.isColor999=!0,o.isclock=!1})}},doCalculation:function(i,e,s){if(0===i)if(this.list[e].items[s].num>this.list[e].items[s].startNum){var c=this.list[e].items[s].num;c--,console.log(t(this.clickNum," at pages\\order\\order.vue:331")),this.changeNum(e,s,this.list[e].items[s].skuId,c)}else l.default.tips("数量不能小于起批量:"+this.list[e].items[s].startNum);else if(this.list[e].items[s].num<this.list[e].items[s].stock){var o=this.list[e].items[s].num;o++,this.changeNum(e,s,this.list[e].items[s].skuId,o)}else l.default.tips("购买数量不能超过库存量:"+this.list[e].items[s].stock)},getCartHasCheck:function(i,e,s){var c=this,o={skuId:this.list[e].items[s].skuId};1===i?(0,h.getCartCheck)(o).then(function(o){c.list[e].items[s].checked=i,console.log(t(c.list," at pages\\order\\order.vue:355")),c.list.forEach(function(t,i){c.hasShopCheckedAll(i)}),c.hasCheckedAll()}).catch(function(t){l.default.tips(t.message||"选中失败")}):(0,h.getCartUncheck)(o).then(function(o){c.list[e].items[s].checked=i,console.log(t(c.list," at pages\\order\\order.vue:366")),c.list.forEach(function(t,i){c.hasShopCheckedAll(i)}),c.hasCheckedAll()}).catch(function(t){l.default.tips(t.message||"选中失败")})},checkChildrenIcon:function(t,i){var e=0===this.list[t].items[i].checked?1:0;this.getCartHasCheck(e,t,i)},hasCheckedAll:function(){var t=0;this.list.forEach(function(i){1===i.checked&&t++}),this.isCheckAll=t===this.list.length},hasShopCheckedAll:function(t){var i=0;this.list[t].items.forEach(function(t){1===t.checked&&i++}),this.list[t].checked=i===this.list[t].items.length?1:0,this.$set(this.list[t],"isColor999",!1),this.calculationTotalMoney()},checkAll:function(){var i=this,e=1;this.isCheckAll&&(e=0),this.isCheckAll=1===e,this.list.forEach(function(t,s){t.checked=e,i.list[s].items.forEach(function(t,c){i.list[s].items[c].checked=e})}),console.log(t(this.list," at pages\\order\\order.vue:419")),this.calculationTotalMoney()},checkParentIcon:function(t){var i=1;1===this.list[t].checked&&(i=0),this.list[t].checked=i,this.list[t].items.forEach(function(t){t.checked=i}),this.hasCheckedAll(),this.calculationTotalMoney()},goHome:function(){s.switchTab({url:"/pages/main/main"})},getCartOrderList:function(){var t=this;this.list=[],(0,h.getCartOrderList)().then(function(i){"1000"===i.code?(t.hasData=i.data.cartLines.length<=0,i.data.cartLines&&i.data.cartLines.length>0&&(t.list=i.data.cartLines,t.list.length>0&&(t.list.forEach(function(i,e){i.checked=0,t.hasShopCheckedAll(e)}),t.hasCheckedAll()))):t.hasData=!0})},preDel:function(){this.isShow=!0},doDel:function(){var i=this,e=[];this.list.forEach(function(t){t.items.forEach(function(t){1===t.checked&&e.push(t.skuId)})}),console.log(t(e," at pages\\order\\order.vue:476"));var s="";e.forEach(function(t,i){e.length-1===i?s+=t:s+=t+","});var c={skuIds:s};(0,h.getCartRemove)(c).then(function(t){"1000"===t.code?(i.isShow=!1,e.length>0?(i.list=[],i.getCartOrderList()):l.default.tips("请选择有效进货单")):l.default.tips(t.message||"删除进货单失败")}).catch(function(t){l.default.tips(t.message||"删除进货单失败")})}}};i.default=m}).call(this,e("0de9")["default"],e("6e42")["default"])},cb8c:function(t,i,e){"use strict";var s=e("1657"),c=e.n(s);c.a},d13f:function(t,i,e){"use strict";(function(t){e("b440"),e("921b");s(e("66fd"));var i=s(e("78d3"));function s(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("6e42")["createPage"])}},[["d13f","common/runtime","common/vendor"]]]);