(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/goodsDetail/goodsDetail"],{"2c46":function(t,o,e){},"7e26":function(t,o,e){"use strict";var s=e("2c46"),i=e.n(s);i.a},a331:function(t,o,e){"use strict";var s=function(){var t=this,o=t.$createElement,s=(t._self._c,e("d028")),i=e("4573"),a=e("c2d5"),n=e("6938"),r=t.__map(t.good.goodsDetailSpecList,function(o,e){var s=t.__map(o.goodsDetailSpecValueList,function(o,e){var s=t.getStatus(o.value),i=t.getStatus(o.value);return{$orig:t.__get_orig(o),m4:s,m5:i}});return{$orig:t.__get_orig(o),l0:s}});t._isMounted||(t.e0=function(o){t.isShare=!0},t.e1=function(o){t.isStandard=!0},t.e2=function(o){t.isSure=!1},t.e3=function(o){t.isSure=!1},t.e4=function(o){t.isShare=!1},t.e5=function(o){t.isStandard=!1}),t.$mp.data=Object.assign({},{$root:{m0:s,m1:i,m2:a,m3:n,l1:r}})},i=[];e.d(o,"a",function(){return s}),e.d(o,"b",function(){return i})},cc9d:function(t,o,e){"use strict";e.r(o);var s=e("cd2d"),i=e.n(s);for(var a in s)"default"!==a&&function(t){e.d(o,t,function(){return s[t]})}(a);o["default"]=i.a},cd2d:function(t,o,e){"use strict";(function(t,s){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=u(e("12ec")),a=u(e("5ff4")),n=e("c87f"),r=(e("7384"),u(e("e0d7"))),d=u(e("122c"));function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return h(t)||g(t)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function g(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function h(t){if(Array.isArray(t)){for(var o=0,e=new Array(t.length);o<t.length;o++)e[o]=t[o];return e}}var f=function(){return Promise.all([e.e("common/vendor"),e.e("components/good/Share")]).then(e.bind(null,"4923"))},m=function(){return e.e("components/common/Player").then(e.bind(null,"e988"))},p=function(){return e.e("components/good/Standard").then(e.bind(null,"491d"))},v=function(){return e.e("components/common/SwiperDot").then(e.bind(null,"32ea"))},S={data:function(){return{imgLoading:!0,opt:!1,indicatorDots:!1,autoplay:!1,interval:5e3,duration:500,shopId:"",goodsId:"",curDisable:!1,nums:1,startNum:1,curs:[],totalPrice:0,stock:0,deep:1,list:[],isPlayer:!1,videoUrl:"",imageList:[],videoObj:{},postType:0,isStandard:!1,good:{hasColletion:!1,rules:[],goods:{},goodsSkuList:[],standardList:[]},cur:0,total:0,icon:{ColSta:i.default,ColAct:a.default},counter:0,isSure:!1,isShare:!1,nav:"",isGoodsTitle:!1,goodsTitle:""}},components:{Share:f,Standard:p,Player:m,SwiperDot:v},computed:{payPrice:function(){return d.default.formatMoney(100*this.totalPrice*this.nums/100,2)}},onLoad:function(t){this.shopId=t.shopId,this.goodsId=t.goodsId},onShow:function(){var o=this;console.log(t("onshow"," at pages\\order\\goodsDetail\\goodsDetail.vue:323")),console.log(t(this.good.goods.detail," at pages\\order\\goodsDetail\\goodsDetail.vue:324")),this.good.goods.detail&&this.onShow(),s.getStorageSync("access_token")&&(0,n.getGoodNums)({status:""}).then(function(t){"1000"==t.code&&(o.counter=t.data.itemNum)}),(0,n.getDetail)({shopId:this.shopId,goodsId:this.goodsId}).then(function(e){if("1000"==e.code){var i=e.data.goodsDetail;i.hasColletion=e.data.hasColletion,i.standardList=[],i.goods.minPrice=d.default.formatMoney(i.goods.minPrice,2),i.goods.maxPrice=d.default.formatMoney(i.goods.maxPrice,2);var a=[];i.goodsImgVOList.forEach(function(t){2!=t.type?a.push(t):o.videoObj[t.sort]=t.imgUrl}),o.imageList=a,o.total=a.length,null==i.goods.unitName&&(i.goods.unitName=i.goodsDetailSpecList[0].name);var u,c=function(t,o){return t[o]={},t[o]},l={},g=[l];i.goodsDetailSpecList.forEach(function(t){var o=[];g.forEach(function(e){t.goodsDetailSpecValueList.forEach(function(t,s){o.push(c(e,t.value))})}),g=o});var h=1==i.goods.showStyle&&i.goodsSkuList.length>1;u=i.goodsDetailSpecList[0].valueSuffix||"";var f=JSON.parse(i.goodsSkuList[0].priceExp);2==i.goods.showStyle&&(i.goodsSkuList[0].price=f[0].price,i.goodsSkuList[0].startNum=f[0].startQuantity);var m=!0;if(i.goodsSkuList.forEach(function(t,o){var e=l,s=t.attrValueList.length;i.standardList[o]=[],t.attrValueList.forEach(function(a,n){e=e[a.value],s-1==n&&(e.disabled=!!(t.stock<t.startNum),e.price=t.price,e.stock=t.stock,e.id=t.id,e.startNum=t.startNum),h?(i.standardList[o].push("".concat(t.startNum).concat(i.goods.unitName,"起批")),i.standardList[o].push("".concat(a.value).concat(3!==+i.goods.showStyle?u:""))):i.standardList[o].push(a.value),m=m&&e.disabled}),i.standardList[o].push("￥".concat(t.price,"/").concat(i.goods.unitName))}),i.tree=l,i.isInvalid=m,i.isInvalid&&(o.isGoodsTitle=!0,o.goodsTitle="库存不足,请浏览别的商品吧~"),3!=i.goods.status&&r.default.tips("商品已下架啦,看下其它的吧"),2==i.goods.showStyle){var p=i.goodsSkuList[0].attrValueList[0];i.goodsList=[];var v=JSON.parse(i.goodsSkuList[0].priceExp);v.forEach(function(t,o){i.goodsList.push({startNum:t.startQuantity,price:t.price,unit:p.name,id:p.skuId})})}i.sufName=u,o.good=i||{},o.deep=o.good.goodsDetailSpecList.length,o.good.goodsDetailSpecList.forEach(function(t){o.curs.push({key:t.goodsDetailSpecValueList[0].value,disabled:void 0})}),o.calcPrice(),o.opt=!0,(0,n.getPostItem)({id:i.goods.postSettingId}).then(function(t){o.postType=t.data.type}),o.good.goods.detail=d.default.formatRichText(o.good.goods.detail),console.log(t(o.good.goods.detail," at pages\\order\\goodsDetail\\goodsDetail.vue:492")),s.getStorageSync("access_token")&&o.getHasCollect(o.goodsId)}})},methods:{imgLoad:function(t){var o=this;setTimeout(function(){o.imgLoading=!1},300)},getHasCollect:function(t){var o=this,e={targetId:t};(0,n.getHasCollect)(e).then(function(t){o.good.hasColletion=t.data})},closePlayer:function(){this.isPlayer=!1,this.videoUrl=""},submitInfo:function(o){console.log(t(o.detail.formId," at pages\\order\\goodsDetail\\goodsDetail.vue:522"))},goHome:function(){s.switchTab({url:"/pages/main/main"})},doIncrease:function(){this.nums<this.stock&&++this.nums,this.calcPrice(1)},doDecrease:function(){+this.nums>this.startNum&&(--this.nums,this.curDisable||(this.nums=this.startNum)),this.calcPrice(1)},checkNum:function(t){var o=+t.target.value;o>this.stock?(r.default.tips("超出库存"+this.stock+"啦"),this.nums=this.stock):o<this.startNum&&(this.curDisable||(r.default.tips("起批量不能低于"+this.startNum),this.nums=this.startNum)),this.calcPrice(1)},getStatus:function(t){for(var o=this.good.tree,e=0;e<this.deep;e++){if(e===this.deep-1)return o=o[t],!!o&&o.disabled;o=o[this.curs[e]["key"]]}},calcPrice:function(t){var o=this;try{var e=this.good.tree;if(2!=this.good.goods.showStyle)this.curs.forEach(function(s,i){e=e[s["key"]],i===o.curs.length-1&&(o.totalPrice=parseFloat(e.price||0),o.stock=e.stock,!t&&(o.nums=e.disabled?0:e.startNum),o.startNum=e.startNum||0,s.disabled=e.disabled,o.curDisable=e.disabled)});else{this.curs.forEach(function(s,i){e=e[s["key"]],i==o.curs.length-1&&(o.stock=e.stock,!t&&(o.nums=e.disabled?0:e.startNum),s.disabled=e.disabled)});var s=c(this.good.goodsList),i=s[0],a=s[s.length-1];s.push({startNum:Math.pow(2,25),price:a.price}),s.unshift({startNum:i.startNum,price:i.price}),this.startNum=i.startNum;for(var n=1,r=s.length-1;n<r;n++)this.nums>=s[n].startNum&&this.nums<s[n+1].startNum&&(this.totalPrice=s[n].price)}}catch(d){}},selOption:function(t,o){this.getStatus();var e=c(this.curs);e[o]["key"]=t,this.curs=e,this.calcPrice()},navigate:function(){for(var t=this,o=!1,e=this.good.tree,i=0;i<this.deep;i++)e=e[this.curs[i]["key"]],i===this.deep-1&&(o=e.disabled);if(o)return r.default.tips("请选择所有的项");if(this.nav.match(/cart/))(0,n.addToCart)({skuId:e.id,num:this.nums}).then(function(o){t.isSure=!1,t.getUpdate()});else if(this.nav.match(/submit/i)){var a=JSON.stringify({addressId:"",goodsCount:this.nums,goodsId:this.goodsId,shopId:this.shopId,skuId:e.id});s.navigateTo({url:"/pages/order/submit/submit?submitData="+a+"&isBuyNow=1"})}else s.navigateTo({url:"/pages/order/order"})},goCart:function(){s.getStorageSync("access_token")?s.switchTab({url:"/pages/order/order"}):s.navigateTo({url:"/pages/login/login"})},goPostSetting:function(t){s.navigateTo({url:"/pages/order/prompt/prompt?id="+t})},getUpdate:function(){var t=this;s.getStorageSync("access_token")&&(0,n.getGoodNums)({status:""}).then(function(o){"1000"==o.code?(t.counter=o.data.itemNum,t.isSure=!1,r.default.tips("已成功加入进货单")):(t.goodsTitle=res.message,t.isGoodsTitle=!0,setTimeout(function(){t.isGoodsTitle=!1},1500))})},play:function(t){3==t.type&&(this.videoUrl=this.videoObj[t.sort],s.navigateTo({url:"/pages/order/goodsDetail/video/video?url="+this.videoUrl}))},triShare:function(){},changeBanner:function(t){this.cur=t.detail.current},showConfirm:function(t){s.getStorageSync("access_token")?(this.nav=t,this.isSure=!0):s.navigateTo({url:"/pages/login/login"})},changeCollect:function(){s.getStorageSync("access_token")?(this.good.hasColletion=!this.good.hasColletion,this.good.hasColletion?r.default.tips("已收藏"):r.default.tips("取消收藏"),this.good.hasColletion?(0,n.setCollect)({goodsId:this.good.goods.id,isLoading:1}):(0,n.removeCollect)({goodsId:this.good.goods.id,isLoading:1})):s.navigateTo({url:"/pages/login/login"})}}};o.default=S}).call(this,e("0de9")["default"],e("6e42")["default"])},e908:function(t,o,e){"use strict";e.r(o);var s=e("a331"),i=e("cc9d");for(var a in i)"default"!==a&&function(t){e.d(o,t,function(){return i[t]})}(a);e("7e26");var n=e("2877"),r=Object(n["a"])(i["default"],s["a"],s["b"],!1,null,"567d2d05",null);o["default"]=r.exports},f299:function(t,o,e){"use strict";(function(t){e("b440"),e("921b");s(e("66fd"));var o=s(e("e908"));function s(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("6e42")["createPage"])}},[["f299","common/runtime","common/vendor"]]]);