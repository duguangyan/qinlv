(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/submit/submit"],{"0690":function(t,e,s){"use strict";s.r(e);var a=s("f1c4"),d=s.n(a);for(var i in a)"default"!==i&&function(t){s.d(e,t,function(){return a[t]})}(i);e["default"]=d.a},"4d9e":function(t,e,s){"use strict";var a,d=function(){var t=this,e=t.$createElement,a=(t._self._c,s("4573")),d=s("b818");t.$mp.data=Object.assign({},{$root:{m0:a,m1:d}})},i=[];s.d(e,"b",function(){return d}),s.d(e,"c",function(){return i}),s.d(e,"a",function(){return a})},d423:function(t,e,s){},eb5b:function(t,e,s){"use strict";s.r(e);var a=s("4d9e"),d=s("0690");for(var i in d)"default"!==i&&function(t){s.d(e,t,function(){return d[t]})}(i);s("f82c");var r,o=s("f0c5"),n=Object(o["a"])(d["default"],a["b"],a["c"],!1,null,"3bdf430c",null,!1,a["a"],r);e["default"]=n.exports},f1c4:function(t,e,s){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var d=c(s("8c11")),i=c(s("9e8e")),r=c(s("8b8c")),o=s("d489"),n=s("c87f"),u=c(s("e0d7"));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(){return Promise.all([s.e("common/vendor"),s.e("components/common/Pay")]).then(s.bind(null,"b0d6"))},f={data:function(){return{isBuyNow:"",submitData:"",list:[],defaultUrl:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2180358788,168891397&fm=26&gp=0.jpg",isPay:!1,Checked:d.default,Uncheck:i.default,Plat:r.default,totalNum:0,totalMoney:0,address:"",message:"",deliverMoney:0,payOrderId:"",cartIdList:"",totalCount:"",hasSuccessShow:!1,platform:0}},components:{Pay:l},onLoad:function(e){var s=this;if(this.submitData=e.submitData,this.isBuyNow=e.isBuyNow,this.platform=t.getStorageSync("platform"),this.isBuyNow){var a=JSON.parse(this.submitData);(0,n.buyGood)(a).then(function(e){s.address=e.data.address||"",s.list=e.data.shopList,s.totalMoney=e.data.totalMoney,s.deliverMoney=e.data.deliverMoney,s.cartIdList=e.data.cartIdList,s.totalCount=e.data.totalCount,t.getStorageSync("address")&&(s.address=JSON.parse(t.getStorageSync("address")),a.addressId=JSON.parse(t.getStorageSync("address")).id,setTimeout(function(){t.setStorageSync("address","")},300))})}else if(this.submitData){var d=JSON.parse(this.submitData);this.list=d.shopList,this.totalMoney=d.totalMoney,this.deliverMoney=d.deliverMoney,this.cartIdList=d.cartIdList,this.totalCount=d.totalCount}},onShow:function(){t.getStorageSync("address")?(this.address=JSON.parse(t.getStorageSync("address")),this.getOrderCartByAddress(this.address.id),setTimeout(function(){t.setStorageSync("address","")},300)):this.getAddressDefAddress()},methods:{doPay:function(t){this.isPay=!1,this.hasSuccessShow=!0},doClose:function(){this.isPay=!1,t.redirectTo({url:"/pages/user/order/detail?orderId="+this.payOrderId})},goAddress:function(){t.navigateTo({url:"/pages/user/addlist/addlist?from=submit"})},showPay:function(){var t=this;if(""==this.address)return u.default.tips("请选择收货地址"),!1;var e={shopParamList:this.list,postscript:this.message,addressId:this.address.id,cartIdList:this.cartIdList};(0,o.postCreateOrder)(e).then(function(e){"1000"===e.code?(t.isPay=""!==t.address,t.payOrderId=e.data.id):u.default.tips(e.message||"提交订单失败")}).catch(function(t){u.default.tips(t.message||"提交订单失败")})},getOrderCartByAddress:function(e){var s=this,a=t.getStorageSync("uid"),d={userId:a,cartIdList:this.cartIdList,addressId:this.address.id,postscript:this.message};if(this.isBuyNow){var i=JSON.parse(this.submitData);this.totalMoney=i.totalMoney,this.deliverMoney=i.deliverMoney}else(0,o.getOrderCart)(d).then(function(t){"1000"===t.code&&(s.totalMoney=t.data.totalMoney,s.deliverMoney=t.data.deliverMoney)}).catch(function(t){u.default.tips(t.message||"结算失败")})},submit:function(){if(""===this.address)return u.default.tips("请选择收货地址"),!1},goDetail:function(e,s){t.navigateTo({url:"/pages/user/order/detail?shopId="+e+"&goodsId="+s})},getAddressDefAddress:function(){var t=this;(0,o.getAddressDefAddress)().then(function(e){"1000"===e.code&&e.data&&(t.address=e.data,t.getOrderCartByAddress(t.address.id))})},getCartList:function(){var t=this;(0,o.getCartOrderList)().then(function(e){if("1000"===e.code){if(e.data.cartLines&&e.data.cartLines.length>0){t.list=e.data.cartLines;var s=0,d=0;t.list.forEach(function(e,i){var r=!1;e.items.forEach(function(t,e){1===t.checked&&(r=!0,s+=t.num,d+=t.totalPrice)}),console.log(a(r+"==="+e.items.length," at pages\\order\\submit\\submit.vue:298")),r&&(t.list[i].checked=1)}),t.totalNum=s,t.totalMoney=d}}else u.default.tips(e.message||"获取进货单列表错误")}).catch(function(t){u.default.tips(t.message||"获取进货单列表错误")})}}};e.default=f}).call(this,s("6e42")["default"],s("0de9")["default"])},f6ee:function(t,e,s){"use strict";(function(t){s("b440"),s("921b");a(s("66fd"));var e=a(s("eb5b"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("6e42")["createPage"])},f82c:function(t,e,s){"use strict";var a=s("d423"),d=s.n(a);d.a}},[["f6ee","common/runtime","common/vendor"]]]);